{"changed":false,"filter":false,"title":"login.controller.js","tooltip":"/D213/Frontend/fetch/login.controller.js","value":"let login = document.getElementById(\"submitInput\");\nlogin.onclick = myLogin;\n\n//\"view\" Button\nlet view = document.getElementById(\"viewTxt\");\nview.onclick = viewButton;\n\n//Confirm Button\nlet confirm = document.getElementById(\"confirmarTxtId\");\nconfirm.onclick = closeForm;\n\n\nfunction myLogin() {\n    if (document.getElementById(\"mailInput\").value.length === 0 || document.getElementById(\"passInput\").value.length === 0) {\n        openForm();\n    }\n    else {\n        let data = {};\n        data.email = document.getElementById(\"mailInput\").value;\n        data.password = document.getElementById(\"passInput\").value;\n        console.log(data); //debugging para ver os dados que foram enviados\n        //chamada fetch para envio dos dados para o servior via POST\n        fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/login', {\n            headers: { 'Content-Type': 'application/json' },\n            method: 'POST',\n            body: JSON.stringify(data)\n        }).then(function(response) {\n            if (!response.ok) {\n                console.log(response.status); //=> number 100â€“599\n                console.log(response.statusText); //=> String\n                console.log(response.headers); //=> Headers\n                console.log(response.url); //=> String\n                openForm();\n                document.getElementById(\"passInput\").value = \"\";\n                document.getElementById(\"mailInput\").value = \"\";\n            }\n            else {\n                let userData = getCookie('userData');\n                let user = JSON.parse(JSON.stringify(userData));\n                if (user.length === 23) {\n                    localStorage.setItem('id_operational_logged', user.slice(20, 22))\n                }\n                else {\n                    localStorage.setItem('id_operational_logged', user.slice(20, 21))\n                }\n                window.location.href = \"MenuPrincipal.html\";\n            }\n        }).then(function(result) {\n            console.log(result);\n        }).catch(function(err) {\n            openForm();\n            document.getElementById(\"passInput\").value = \"\";\n            document.getElementById(\"mailInput\").value = \"\";\n            console.error(err);\n        });\n    }\n}\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var decodedCookie = decodeURIComponent(document.cookie);\n    var ca = decodedCookie.split(';');\n    for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n//Fuction of the \"view\" button\nfunction viewButton() {\n    let view = document.getElementById(\"passInput\");\n    if (view.type === \"password\") {\n        view.type = \"text\";\n    }\n    else {\n        view.type = \"password\";\n    }\n}\n\n\n//Error Open Close Functions\nfunction openForm() {\n    document.getElementById(\"textTxt1\").className = \"textTxtClass text-center\";\n    document.getElementById(\"textTxt\").className = \"hidden\";\n    document.getElementById(\"errorFrame\").className = \"errorFrame\";\n}\n\nfunction closeForm() {\n    document.getElementById(\"errorFrame\").className = \"hidden\";\n}\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":450,"scrollleft":0,"selection":{"start":{"row":37,"column":16},"end":{"row":44,"column":17},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":27,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1611507339938}