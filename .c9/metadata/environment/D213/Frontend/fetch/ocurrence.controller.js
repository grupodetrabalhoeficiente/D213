{"filter":false,"title":"ocurrence.controller.js","tooltip":"/D213/Frontend/fetch/ocurrence.controller.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":91,"column":3},"action":"remove","lines":["/*//quando inicia a página faz","window.onload = function() {","    //chama a função para atualizar os users","    refreshUsers(); //adicionar função de validação ao formulário","    validator();","    document.getElementById(\"formNewUser\").onsubmit = function(e) {","        //validação do formulário ao submeter","        validator();","    };","","    //função de validação","    function validator() {","        let validator = new Validator(document.querySelector('form[name=\"formNewUser\"]'), function(err, res) {","            if (res) {","                saveUsers();","            }","        }, {","            rules: {","                password: function(value) {","                    return (value === document.getElementById(\"pwd\").value);","                }","            },","            messages: {","                en: {","                    password: {","                        incorrect: \"Password didn't match\"","                    }","                }","            }","        });","    }","","    function saveUsers() {","        var data = {};","        data.name = document.getElementById(\"name\").value;","        data.email = document.getElementById(\"email\").value;","        data.pass = document.getElementById(\"pwd\").value;","        console.log(data); //debugging para ver os dados que foram enviados","        //chamada fetch para envio dos dados para o servior via POST","        fetch('https://umpw-cfportela.c9users.io/users', {","            headers: { 'Content-Type': 'application/json' },","            method: 'POST',","            body: JSON.stringify(data)","        }).then(function(response) {","            if (!response.ok) {","                console.log(response.status); //=> number 100–599","                console.log(response.statusText); //=> String","                console.log(response.headers); //=> Headers","                console.log(response.url); //=> String","                if (response.status === 409) {","                    alert(\"Duplicated Email\");","                }","                else {","                    throw Error(response.statusText);","                }","            }","            else {","                document.getElementById(\"formNewUser\").reset(); //limpeza dos dados do form","                alert(\"submitted with success\");","                refreshUsers();","            }","        }).then(function(result) {","            console.log(result);","        }).catch(function(err) {","            alert(\"Submission error\");","            console.error(err);","        });","","        function refreshUsers() {","            async function fetchAsync() {","                const renderUsers = document.getElementById(\"result\");","                let txt = \"\";","                const response = await fetch('https://umpw-cfportela.c9users.io/users');","                const users = await response.json();","                //criação de uma tabela para demonstração dos resultados recebidos","                txt += \"<table class='table' style='padding:10px; width:70%; margin:0% 15% 0% 15%'>\";","                txt += \"<thead style='background-color:#607d8b; color:white '>\";","                txt += \"<tr><th>Name</th><th>Email</th><th>Reg. Date</th></tr></thead><tbody>\";","                //percorrer a variável users e por cada user cria a linha da tabela com os dados presentes","                for (const user of users) {","                    txt += \"<tr><td style='text-align:right'>\" + user.name + \"</td><td>\" + user.email + \"</td><td>\" +","                        user.dateReg + \"</td></tr>\";","                }","                txt += \"</tbody></table>\";","                //envia a tabela construida para a view e mostra no object com ID result","                renderUsers.innerHTML = txt;","            }","            //chama a função fetchAsync()","            fetchAsync().then(data => console.log(\"ok\")).catch(reason => console.log(reason.message));","        }","    };","}*/"],"id":2}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":1,"column":0},"end":{"row":1,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1610838426917,"hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"}