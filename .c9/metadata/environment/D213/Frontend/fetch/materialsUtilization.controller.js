{"changed":true,"filter":false,"title":"materialsUtilization.controller.js","tooltip":"/D213/Frontend/fetch/materialsUtilization.controller.js","value":"const id_occurrence = \"1\";\nconst submit = document.getElementById(\"submit\");\nsubmit.onclick = updateConfirmation;\nlet rows = {};\nlet obj = [];\n\nfunction fillTable() {\n    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials_utilizations')\n        .then(res => res.json())\n        .then((out) => {\n            $('#table tbody').empty();\n            $.each(out, function(index, value) {\n                obj.push({ \"id_vei_mat\": value.id_vei_mat });\n                $('#table tbody').append('<tr class=\"fullRow\"><th class =\"id_material\"scope=\"row\">' + value.id_vei_mat + '</th><td>' + value.material_type + '</td> <td>  <label class=\"custom-checkbox\" tab-index=\"0\" aria-label=\"Checkbox Label\"> <input class=\"utilization\"type=\"checkbox\" checked> <span class=\"checkmark\"></span> </label> </td> </tr>')\n            });\n            console.log(obj);\n            rows = JSON.stringify(obj);\n        }).catch(err => console.error(err));\n}\n\nfunction updateConfirmation() {\n    let confirmation = {};\n    let data = {};\n    data = document.getElementsByClassName(\"fullRow\");\n    for (let c = 0; c < data.length; c++) {\n        for (let id_vei_mat in obj) {\n            if (obj[id_vei_mat].id_vei_mat == data[c].getElementsByClassName(\"id_material\").item(0).innerHTML) {\n                if (data[c].getElementsByClassName(\"confirmation\").item(0).disabled === false) {\n                    if (data[c].getElementsByClassName(\"confirmation\").item(0).checked === true) {\n                        confirmation.confirmation = '1';\n                    }\n                    else {\n                        confirmation.confirmation = '0';\n                    }\n                    console.log(confirmation);\n                    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials/' + obj[id_vei_mat].id_vei_mat.toString(), {\n                        headers: { 'Content-Type': 'application/json' },\n                        method: 'PUT',\n                        body: JSON.stringify(confirmation)\n                    }).then(function(response) {\n                        if (!response.ok) {\n                            console.log(response.status); //=> number 100–599\n                            console.log(response.statusText); //=> String\n                            console.log(response.headers); //=> Headers\n                            console.log(response.url); //=> String\n                            console.log(confirmation);\n                        }\n                        else {\n                            data[c].getElementsByClassName(\"confirmation\").item(0).disabled = true;\n                        }\n                    }).then(function(result) {\n                        console.log(result);\n                    }).catch(function(err) {\n                        alert(\"Submission error\");\n                        console.error(err);\n                    });\n                }\n            }\n        }\n\n    }\n}\n\n\n$(document).ready(function() {\n    fillTable();\n})\n","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":0,"column":0},"end":{"row":66,"column":2},"action":"insert","lines":["const id_occurrence = \"1\";","const submit = document.getElementById(\"submit\");","submit.onclick = updateConfirmation;","let rows = {};","let obj = [];","","function fillTable() {","    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials')","        .then(res => res.json())","        .then((out) => {","            $('#table tbody').empty();","            $.each(out, function(index, value) {","                obj.push({ \"id_vei_mat\": value.id_vei_mat });","                $('#table tbody').append('<tr class=\"fullRow\"><th class =\"id_material\"scope=\"row\">' + value.id_vei_mat + '</th><td>' + value.material_type + '</td> <td>  <label class=\"custom-checkbox\" tab-index=\"0\" aria-label=\"Checkbox Label\"> <input class=\"confirmation\"type=\"checkbox\" checked> <span class=\"checkmark\"></span> </label> </td> </tr>')","            });","            console.log(obj);","            rows = JSON.stringify(obj);","        }).catch(err => console.error(err));","}","","function updateConfirmation() {","    let confirmation = {};","    let data = {};","    data = document.getElementsByClassName(\"fullRow\");","    for (let c = 0; c < data.length; c++) {","        for (let id_vei_mat in obj) {","            if (obj[id_vei_mat].id_vei_mat == data[c].getElementsByClassName(\"id_material\").item(0).innerHTML) {","                if (data[c].getElementsByClassName(\"confirmation\").item(0).disabled === false) {","                    if (data[c].getElementsByClassName(\"confirmation\").item(0).checked === true) {","                        confirmation.confirmation = '1';","                    }","                    else {","                        confirmation.confirmation = '0';","                    }","                    console.log(confirmation);","                    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials/' + obj[id_vei_mat].id_vei_mat.toString(), {","                        headers: { 'Content-Type': 'application/json' },","                        method: 'PUT',","                        body: JSON.stringify(confirmation)","                    }).then(function(response) {","                        if (!response.ok) {","                            console.log(response.status); //=> number 100–599","                            console.log(response.statusText); //=> String","                            console.log(response.headers); //=> Headers","                            console.log(response.url); //=> String","                            console.log(confirmation);","                        }","                        else {","                            data[c].getElementsByClassName(\"confirmation\").item(0).disabled = true;","                        }","                    }).then(function(result) {","                        console.log(result);","                    }).catch(function(err) {","                        alert(\"Submission error\");","                        console.error(err);","                    });","                }","            }","        }","","    }","}","","","$(document).ready(function() {","    fillTable();","})"],"id":1}],[{"start":{"row":7,"column":130},"end":{"row":7,"column":131},"action":"insert","lines":["_"],"id":2},{"start":{"row":7,"column":131},"end":{"row":7,"column":132},"action":"insert","lines":["u"]},{"start":{"row":7,"column":132},"end":{"row":7,"column":133},"action":"insert","lines":["t"]},{"start":{"row":7,"column":133},"end":{"row":7,"column":134},"action":"insert","lines":["i"]},{"start":{"row":7,"column":134},"end":{"row":7,"column":135},"action":"insert","lines":["l"]},{"start":{"row":7,"column":135},"end":{"row":7,"column":136},"action":"insert","lines":["i"]},{"start":{"row":7,"column":136},"end":{"row":7,"column":137},"action":"insert","lines":["z"]},{"start":{"row":7,"column":137},"end":{"row":7,"column":138},"action":"insert","lines":["a"]},{"start":{"row":7,"column":138},"end":{"row":7,"column":139},"action":"insert","lines":["t"]},{"start":{"row":7,"column":139},"end":{"row":7,"column":140},"action":"insert","lines":["i"]},{"start":{"row":7,"column":140},"end":{"row":7,"column":141},"action":"insert","lines":["o"]}],[{"start":{"row":7,"column":141},"end":{"row":7,"column":142},"action":"insert","lines":["n"],"id":3},{"start":{"row":7,"column":142},"end":{"row":7,"column":143},"action":"insert","lines":["s"]}],[{"start":{"row":66,"column":2},"end":{"row":67,"column":0},"action":"insert","lines":["",""],"id":4}],[{"start":{"row":13,"column":258},"end":{"row":13,"column":270},"action":"remove","lines":["confirmation"],"id":5},{"start":{"row":13,"column":258},"end":{"row":13,"column":259},"action":"insert","lines":["u"]},{"start":{"row":13,"column":259},"end":{"row":13,"column":260},"action":"insert","lines":["t"]},{"start":{"row":13,"column":260},"end":{"row":13,"column":261},"action":"insert","lines":["i"]},{"start":{"row":13,"column":261},"end":{"row":13,"column":262},"action":"insert","lines":["l"]},{"start":{"row":13,"column":262},"end":{"row":13,"column":263},"action":"insert","lines":["i"]},{"start":{"row":13,"column":263},"end":{"row":13,"column":264},"action":"insert","lines":["z"]},{"start":{"row":13,"column":264},"end":{"row":13,"column":265},"action":"insert","lines":["a"]},{"start":{"row":13,"column":265},"end":{"row":13,"column":266},"action":"insert","lines":["t"]},{"start":{"row":13,"column":266},"end":{"row":13,"column":267},"action":"insert","lines":["i"]}],[{"start":{"row":13,"column":267},"end":{"row":13,"column":268},"action":"insert","lines":["o"],"id":6},{"start":{"row":13,"column":268},"end":{"row":13,"column":269},"action":"insert","lines":["n"]}],[{"start":{"row":0,"column":0},"end":{"row":67,"column":0},"action":"remove","lines":["const id_occurrence = \"1\";","const submit = document.getElementById(\"submit\");","submit.onclick = updateConfirmation;","let rows = {};","let obj = [];","","function fillTable() {","    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials_utilizations')","        .then(res => res.json())","        .then((out) => {","            $('#table tbody').empty();","            $.each(out, function(index, value) {","                obj.push({ \"id_vei_mat\": value.id_vei_mat });","                $('#table tbody').append('<tr class=\"fullRow\"><th class =\"id_material\"scope=\"row\">' + value.id_vei_mat + '</th><td>' + value.material_type + '</td> <td>  <label class=\"custom-checkbox\" tab-index=\"0\" aria-label=\"Checkbox Label\"> <input class=\"utilization\"type=\"checkbox\" checked> <span class=\"checkmark\"></span> </label> </td> </tr>')","            });","            console.log(obj);","            rows = JSON.stringify(obj);","        }).catch(err => console.error(err));","}","","function updateConfirmation() {","    let confirmation = {};","    let data = {};","    data = document.getElementsByClassName(\"fullRow\");","    for (let c = 0; c < data.length; c++) {","        for (let id_vei_mat in obj) {","            if (obj[id_vei_mat].id_vei_mat == data[c].getElementsByClassName(\"id_material\").item(0).innerHTML) {","                if (data[c].getElementsByClassName(\"confirmation\").item(0).disabled === false) {","                    if (data[c].getElementsByClassName(\"confirmation\").item(0).checked === true) {","                        confirmation.confirmation = '1';","                    }","                    else {","                        confirmation.confirmation = '0';","                    }","                    console.log(confirmation);","                    fetch('https://bdc5dcf6bca04b39ab10a706cdb79f29.vfs.cloud9.us-east-1.amazonaws.com/occurrences/' + id_occurrence + '/materials/' + obj[id_vei_mat].id_vei_mat.toString(), {","                        headers: { 'Content-Type': 'application/json' },","                        method: 'PUT',","                        body: JSON.stringify(confirmation)","                    }).then(function(response) {","                        if (!response.ok) {","                            console.log(response.status); //=> number 100–599","                            console.log(response.statusText); //=> String","                            console.log(response.headers); //=> Headers","                            console.log(response.url); //=> String","                            console.log(confirmation);","                        }","                        else {","                            data[c].getElementsByClassName(\"confirmation\").item(0).disabled = true;","                        }","                    }).then(function(result) {","                        console.log(result);","                    }).catch(function(err) {","                        alert(\"Submission error\");","                        console.error(err);","                    });","                }","            }","        }","","    }","}","","","$(document).ready(function() {","    fillTable();","})",""],"id":7,"ignore":true}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":81,"selection":{"start":{"row":41,"column":43},"end":{"row":41,"column":43},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1610839286676}