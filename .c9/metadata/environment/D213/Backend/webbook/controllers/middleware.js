{"changed":false,"filter":false,"title":"middleware.js","tooltip":"/D213/Backend/webbook/controllers/middleware.js","value":"const jwt = require('jsonwebtoken')\n\nexports.verify = function(req, res, next){\n    let accessToken = req.cookies.jwt;\n    //if there is no token stored in cookies, the request is unauthorized\n    if (!accessToken){\n        return res.status(403).send()\n    }\n\n    let payload\n    try{\n        //use the jwt.verify method to verify the access token\n        //throws an error if the token has expired or has a invalid signature\n        payload = jwt.verify(accessToken, process.env.ACCESS_TOKEN_SECRET)\n        next();\n    }\n    catch(e){\n        //if an error occured return request unauthorized error\n        return res.status(401).send()\n    }\n}\n\n\nexports.verifyresponsible = function(req, res, next){\n    let accessToken = req.cookies.jwtresponsible;\n   // console.log(jwt.verify(accessToken, process.env.ACCESS_TOKEN_SECRET));\n    //if there is no token stored in cookies, the request is unauthorized\n    if (!accessToken){\n        return res.status(403).send()\n    }\n    let payload\n    try{\n        //use the jwt.verify method to verify the access token\n        //throws an error if the token has expired or has a invalid signature\n        payload = jwt.verify(accessToken, process.env.ACCESS_TOKEN_SECRET)\n        next();\n    }\n    catch(e){\n        //if an error occured return request unauthorized error\n        return res.status(401).send()\n    }\n}","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":166,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":41,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":9,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1611507224480}